{% extends base_template %}
{% load humanize bnchmrk_tag %}

{% block page_content %}


{% if num_employers >= EMPLOYER_THRESHOLD %}
    <div class="card section">
        <div class="row">
            <div class="col-md-6 section-content-left">
                <div class="col-md-9">
                <table class="table table-striped table-content">
                    <col width="60%">
                    <col width="40%">
                    <thead>
                        <th class="row-label">Premium Cost Share</th>
                        <th>Employers</th>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="row-label">100% Employer Paid Only</td>
                            <td>{{ prcnt_paid }}%</td>
                        </tr>
                        <tr>
                            <td class="row-label">Employee Cost Share Only</td>
                            <td>{{ prcnt_share }}%</td>
                        </tr>
                        <tr>
                            <td class="row-label">Core & Buy Up Plans</td>
                            <td>{{ prcnt_paid_share }}%</td>
                        </tr>
                        <tr>
                            <td class="row-label">Not Reported</td>
                            <td>{{ prcnt_non_reported }}%</td>
                        </tr>
                    </tbody>
                </table>  
                </div>
                <div class="col-md-3">
                    <div id="bar-chart" style="height: 190px;"></div>
                </div>
            </div>
            <div class="col-md-6 section-content-right">
                <div class="col-md-9">
                <table class="table table-striped table-content">
                    <col width="60%">
                    <col width="40%">
                    <thead>
                        <tr>
                            <th class="row-label">Number of Plans Offered</th>
                            <th>Employers</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="row-label">No Plans Offered</td>
                            <td>{{ prcnt_plan0 }}%</td>
                        </tr>
                        <tr>
                            <td class="row-label">One Plan Offered</td>
                            <td>{{ prcnt_plan1 }}%</td>
                        </tr>
                        <tr>
                            <td class="row-label">Two Plans Offered</td>
                            <td>{{ prcnt_plan2 }}%</td>
                        </tr>
                        <tr>
                            <td class="row-label">Three or More Plans Offered</td>
                            <td>{{ prcnt_plan3_or_more }}%</td>
                        </tr>
                    </tbody>
                </table>
                </div>
                <div class="col-md-3">
                    <div id="donut-chart" class="flot-chart-pie" style="height: 190px;"></div>
                </div>        
            </div>
        </div>
    </div>

    <div class="card section">
        <div class="row">
        <div class="col-md-5 section-content">
            <table class="table table-striped table-content">
                <col width="50%">
                <col width="25%">
                <col width="25%">
                <thead>
                    <tr>
                        <th class="row-label">STD Coverage</th>
                        <th>Benchmark</th>
                        <th class="toggle_plan">Your Plan</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="row-label">Weekly Maximum Benefit</td>
                        <td>{{ mdn_weekly_max }}</td>
                        <td><span id="prop_weekly_max"></span></td>
                    </tr>
                    <tr>
                        <td class="row-label">Replacement Percentage</td>
                        <td>{{ mdn_percentage }}</td>
                        <td><span id="prop_percentage"></span></td>
                    </tr>
                    <tr>
                        <td class="row-label">Waiting Days For Injury</td>
                        <td>{{ mdn_waiting_days }}</td>
                        <td><span id="prop_waiting_days"></span></td>
                    </tr>
                    <tr>
                        <td class="row-label">Waiting Days For Illness</td>
                        <td>{{ mdn_waiting_days_sick }}</td>
                        <td><span id="prop_waiting_days_sick"></span></td>
                    </tr>
                    <tr>
                        <td class="row-label">Duration Weeks</td>
                        <td>{{ mdn_duration_weeks }}</td>
                        <td><span id="prop_duration_weeks"></span></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="col-md-7 section-graph">
            <div class="col-sm-12 m-b-15 m-r-25">
                <select class="selectpicker property" onchange="update_quintile(this, 'STD-1', 'prop_rank_weekly_max', false);">
                    <option type="dollar" value="weekly_max">Weekly Maximum Benefit</option>
                    <option type="percent" value="percentage">Replacement Percentage</option>
                </select>
            </div>                
            <div class="col-md-10">
                <div id="STD-1" class="flot-chart"></div>
            </div>
            <div class="col-md-2 section-score text-center">
                <h5 class="toggle_plan">Percentile Rank</h5>
                <p><span id="prop_rank_{{ quintile_properties|parse_list:0 }}" class="prop_rank_weekly_max"></span></p>           
            </div> 
        </div>              
        </div>
    </div>

{% else %}
    {% include 'includes/too-few-employers.html' %}
{% endif %}


<script type="text/javascript">
var quintile_properties_, quintile_properties_inv_;
quintile_properties_ = {{ quintile_properties|safe }};
quintile_properties_inv_ = {{ quintile_properties_inv|safe }};

var gh1_data, gh3_data, gh4_data;
var plan_type = '{{ request.session.plan_type }}';

{% if num_employers >= EMPLOYER_THRESHOLD %}
    gh1_data = {{ quintile_0 }};

    gh3_data = [
        {data: {{ prcnt_plan0 }}, color: '#795548', label: 'No Plans Offered'},
        {data: {{ prcnt_plan1 }}, color: '#FFC107', label: 'One Plan Offered'},
        {data: {{ prcnt_plan2 }}, color: '#009688', label: 'Two Plans Offered'},
        {data: {{ prcnt_plan3_or_more }}, color: '#9E9E9E', label: 'Three or More Plans Offered'},
    ];        

    gh4_data = [{
        data : [['100% Employer Paid Only', {{ prcnt_paid|cut:'%' }}], ['Employee Cost Share Only', {{ prcnt_share|cut:'%' }}], ['Core & Buy Up Plans', {{ prcnt_paid_share|cut:'%' }}]],
        bars : {
            show : true,
            barWidth : 0.3,
            order : 1,
            lineWidth: 0,
            fillColor: '#607D8B'
        }
    }]; 
    
    var attribute_map = [
        {
            data: gh1_data,
            placeholder: 'STD-1',
            weekly_max: 'dollar',
            percentage: 'percent',
            inverse: false
        }
    ];

{% endif %}
</script>
{% endblock %}